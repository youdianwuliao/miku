(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{1168:function(e,t,r){"use strict";r.r(t);var n=r(6),o=r(110),l=(r(49),r(21),r(116),r(48),r(769)),c=Object(l.createFFmpeg)({log:!0,corePath:"https://unpkg.com/@ffmpeg/core@0.10.0/dist/ffmpeg-core.js"}),f={name:"ffmpeg",head:function(){return this.$store.state.currentTool.head},data:function(){return{n:null,file:null,loading:!0,type:"MP4",typeList:{MP4:"MP4",AVI:"AVI",MOV:"MOV",WEBM:"WEBM"},resultVideoUrl:"",resultVideoName:""}},computed:{outputName:function(){if(this.file){var e=this.file.name.split(".").reverse(),t=Object(o.a)(e),r=(t[0],t.slice(1));return"".concat(r.join("."),".").concat(this.type.toLowerCase())}return""}},mounted:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.load();case 2:e.loading=!1;case 3:case"end":return t.stop()}}),t)})))()},methods:{handleChange:function(e){var t=e.target;t.files.length&&(this.file=t.files[0])},convert:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,r=e.file.name,n=e.type.toLowerCase(),t.t0=c,t.t1=r,t.next=7,Object(l.fetchFile)(e.file);case 7:return t.t2=t.sent,t.t0.FS.call(t.t0,"writeFile",t.t1,t.t2),e.resultVideoName=e.outputName,t.next=12,c.run("-i",r,e.resultVideoName);case 12:data=c.FS("readFile",e.resultVideoName),e.resultVideoUrl=URL.createObjectURL(new Blob([data.buffer],{type:"video/".concat(n)})),e.loading=!1;case 15:case"end":return t.stop()}}),t)})))()}}},m=(r(777),r(2)),component=Object(m.a)(f,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"ffmpeg"},[t("nya-container",{attrs:{title:"媒体格式转换"}},[t("div",{staticClass:"inputbtn"},[t("nya-input",{staticClass:"upfile",attrs:{type:"file",label:"请选择要转换的媒体文件",placeholder:"点击这里上传文件"},on:{change:e.handleChange},model:{value:e.n,callback:function(t){e.n=t},expression:"n"}}),e._v(" "),t("button",{staticClass:"nya-btn",attrs:{type:"button",disabled:e.loading||!e.file},on:{click:e.convert}},[e._v("\n                "+e._s(e.loading?"加载中":"开始转换")+"\n            ")])],1),e._v(" "),t("div",{staticClass:"typeList"},[t("nya-select",{attrs:{fullwidth:"",items:e.typeList,disabled:e.loading,label:"选择格式"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}})],1)]),e._v(" "),e.resultVideoUrl?t("nya-container",{attrs:{title:"转换成功"}},[t("div",{staticClass:"result"},[t("video",{attrs:{src:e.resultVideoUrl,controls:"",preload:""}})])]):e._e(),e._v(" "),t("nya-container",{attrs:{title:"说明"}},[t("ul",{staticClass:"nya-list"},[t("li",[e._v("全部转换均在浏览器内进行，不会消耗设备流量")]),e._v(" "),t("li",[e._v("如果转换时间过长请使用其他浏览器尝试，推荐使用Chrome")]),e._v(" "),t("li",[e._v("\n                基于"),t("a",{attrs:{target:"_blank",href:"https://github.com/ffmpegwasm/ffmpeg.wasm"}},[e._v("ffmpeg.wasm")])])])])],1)}),[],!1,null,null,null);t.default=component.exports},436:function(e,t,r){var n,o;n=function(){function e(){var e=arguments.length;if(0===e)throw new Error("resolveUrl requires at least one argument; got none.");var base=document.createElement("base");if(base.href=arguments[0],1===e)return base.href;var head=document.getElementsByTagName("head")[0];head.insertBefore(base,head.firstChild);for(var t,a=document.createElement("a"),r=1;r<e;r++)a.href=arguments[r],t=a.href,base.href=t;return head.removeChild(base),t}return e},void 0===(o="function"==typeof n?n.call(t,r,t,e):n)||(e.exports=o)},489:function(e,t){let r=!1,n=()=>{};e.exports={logging:r,setLogging:e=>{r=e},setCustomLogger:e=>{n=e},log:(e,t)=>{n({type:e,message:t}),r&&console.log(`[${e}] ${t}`)}}},490:function(e,t,r){const n=r(774),o=r(775),l=r(776);e.exports={defaultOptions:n,getCreateFFmpegCore:o,fetchFile:l}},491:function(e){e.exports=JSON.parse('{"name":"@ffmpeg/ffmpeg","version":"0.10.1","description":"FFmpeg WebAssembly version","main":"src/index.js","types":"src/index.d.ts","directories":{"example":"examples"},"scripts":{"start":"node scripts/server.js","build":"rimraf dist && webpack --config scripts/webpack.config.prod.js","prepublishOnly":"npm run build","lint":"eslint src","wait":"rimraf dist && wait-on http://localhost:3000/dist/ffmpeg.dev.js","test":"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:ffmpeg test:node:all","test:node":"node --experimental-wasm-threads --experimental-wasm-bulk-memory node_modules/.bin/_mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser":"mocha-headless-chrome -a allow-file-access-from-files -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:ffmpeg":"npm run test:browser -- -f ./tests/ffmpeg.test.html"},"browser":{"./src/node/index.js":"./src/browser/index.js"},"repository":{"type":"git","url":"git+https://github.com/ffmpegwasm/ffmpeg.wasm.git"},"keywords":["ffmpeg","WebAssembly","video"],"author":"Jerome Wu <jeromewus@gmail.com>","license":"MIT","bugs":{"url":"https://github.com/ffmpegwasm/ffmpeg.wasm/issues"},"engines":{"node":">=12.16.1"},"homepage":"https://github.com/ffmpegwasm/ffmpeg.wasm#readme","dependencies":{"is-url":"^1.2.4","node-fetch":"^2.6.1","regenerator-runtime":"^0.13.7","resolve-url":"^0.2.1"},"devDependencies":{"@babel/core":"^7.12.3","@babel/preset-env":"^7.12.1","@ffmpeg/core":"^0.10.0","@types/emscripten":"^1.39.4","babel-loader":"^8.1.0","chai":"^4.2.0","cors":"^2.8.5","eslint":"^7.12.1","eslint-config-airbnb-base":"^14.1.0","eslint-plugin-import":"^2.22.1","express":"^4.17.1","mocha":"^8.2.1","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","wait-on":"^5.3.0","webpack":"^5.3.2","webpack-cli":"^4.1.0","webpack-dev-middleware":"^4.0.0"}}')},492:function(e,t,r){var content=r(778);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(4).default)("4148432b",content,!0,{sourceMap:!1})},769:function(e,t,r){r(49);const n=r(770),{fetchFile:o}=r(490);e.exports={createFFmpeg:n,fetchFile:o}},770:function(e,t,r){const{defaultArgs:n,baseOptions:o}=r(771),{setLogging:l,setCustomLogger:c,log:f}=r(489),m=r(772),d=r(773),{defaultOptions:h,getCreateFFmpegCore:w}=r(490),{version:y}=r(491),v=Error("ffmpeg.wasm is not ready, make sure you have completed load().");e.exports=(e={})=>{const{log:t,logger:r,progress:F,...x}={...o,...h,...e};let E=null,j=null,C=null,_=!1,progress=F;const k=({type:e,message:t})=>{f(e,t),m(t,progress),(e=>{"FFMPEG_END"===e&&null!==C&&(C(),C=null,_=!1)})(t)};return l(t),c(r),f("info",`use ffmpeg.wasm v${y}`),{setProgress:e=>{progress=e},setLogger:e=>{c(e)},setLogging:l,load:async()=>{if(f("info","load ffmpeg-core"),null!==E)throw Error("ffmpeg.wasm was loaded, you should not load it again, use ffmpeg.isLoaded() to check next time.");{f("info","loading ffmpeg-core");const{createFFmpegCore:e,corePath:t,workerPath:r,wasmPath:n}=await w(x);E=await e({mainScriptUrlOrBlob:t,printErr:e=>k({type:"fferr",message:e}),print:e=>k({type:"ffout",message:e}),locateFile:(path,e)=>{if("undefined"!=typeof window){if(void 0!==n&&path.endsWith("ffmpeg-core.wasm"))return n;if(void 0!==r&&path.endsWith("ffmpeg-core.worker.js"))return r}return e+path}}),j=E.cwrap("proxy_main","number",["number","number"]),f("info","ffmpeg-core loaded")}},isLoaded:()=>null!==E,run:(...e)=>{if(f("info",`run ffmpeg command: ${e.join(" ")}`),null===E)throw v;if(_)throw Error("ffmpeg.wasm can only run one command at a time");return _=!0,new Promise((t=>{const r=[...n,...e].filter((s=>0!==s.length));C=t,j(...d(E,r))}))},exit:()=>{if(null===E)throw v;_=!1,E.exit(1),E=null,j=null,C=null},FS:(e,...t)=>{if(f("info",`run FS.${e} ${t.map((e=>"string"==typeof e?e:`<${e.length} bytes binary file>`)).join(" ")}`),null===E)throw v;{let r=null;try{r=E.FS[e](...t)}catch(r){throw"readdir"===e?Error(`ffmpeg.FS('readdir', '${t[0]}') error. Check if the path exists, ex: ffmpeg.FS('readdir', '/')`):"readFile"===e?Error(`ffmpeg.FS('readFile', '${t[0]}') error. Check if the path exists`):Error("Oops, something went wrong in FS operation.")}return r}}}}},771:function(e,t){e.exports={defaultArgs:["./ffmpeg","-nostdin","-y"],baseOptions:{log:!1,logger:()=>{},progress:()=>{},corePath:""}}},772:function(e,t){let r=0,n=0;const o=e=>{const[t,r,s]=e.split(":");return 60*parseFloat(t)*60+60*parseFloat(r)+parseFloat(s)};e.exports=(e,progress)=>{if("string"==typeof e)if(e.startsWith("  Duration")){const t=e.split(", ")[0].split(": ")[1],l=o(t);progress({duration:l,ratio:n}),(0===r||r>l)&&(r=l)}else if(e.startsWith("frame")||e.startsWith("size")){const t=e.split("time=")[1].split(" ")[0],l=o(t);n=l/r,progress({ratio:n,time:l})}else e.startsWith("video:")&&(progress({ratio:1}),r=0)}},773:function(e,t){e.exports=(e,t)=>{const r=e._malloc(t.length*Uint32Array.BYTES_PER_ELEMENT);return t.forEach(((s,t)=>{const n=e._malloc(s.length+1);e.writeAsciiToMemory(s,n),e.setValue(r+Uint32Array.BYTES_PER_ELEMENT*t,n,"i32")})),[t.length,r]}},774:function(e,t,r){r(436);const{devDependencies:n}=r(491);e.exports={corePath:`https://unpkg.com/@ffmpeg/core@${n["@ffmpeg/core"].substring(1)}/dist/ffmpeg-core.js`}},775:function(e,t,r){const n=r(436),{log:o}=r(489),l=async(e,t)=>{o("info",`fetch ${e}`);const r=await(await fetch(e)).arrayBuffer();o("info",`${e} file size = ${r.byteLength} bytes`);const n=new Blob([r],{type:t}),l=URL.createObjectURL(n);return o("info",`${e} blob URL = ${l}`),l};e.exports=async({corePath:e})=>{if("string"!=typeof e)throw Error("corePath should be a string!");const t=n(e),r=await l(t,"application/javascript"),c=await l(t.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),f=await l(t.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return"undefined"==typeof createFFmpegCore?new Promise((e=>{const script=document.createElement("script"),t=()=>{script.removeEventListener("load",t),o("info","ffmpeg-core.js script loaded"),e({createFFmpegCore:createFFmpegCore,corePath:r,wasmPath:c,workerPath:f})};script.src=r,script.type="text/javascript",script.addEventListener("load",t),document.getElementsByTagName("head")[0].appendChild(script)})):(o("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore:createFFmpegCore,corePath:r,wasmPath:c,workerPath:f}))}},776:function(e,t,r){const n=r(436);e.exports=async e=>{let data=e;if(void 0===e)return new Uint8Array;if("string"==typeof e)if(/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e))data=atob(e.split(",")[1]).split("").map((e=>e.charCodeAt(0)));else{const t=await fetch(n(e));data=await t.arrayBuffer()}else(e instanceof File||e instanceof Blob)&&(data=await(t=e,new Promise(((e,r)=>{const n=new FileReader;n.onload=()=>{e(n.result)},n.onerror=({target:{error:{code:code}}})=>{r(Error(`File could not be read! Code=${code}`))},n.readAsArrayBuffer(t)}))));var t;return new Uint8Array(data)}},777:function(e,t,r){"use strict";r(492)},778:function(e,t,r){var n=r(3)((function(i){return i[1]}));n.push([e.i,".ffmpeg .progress,.ffmpeg .typeList{margin-top:.9375rem}",""]),n.locals={},e.exports=n}}]);